<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Avalia√ß√£o de Auto-Estima Saud√°vel ‚Äî Instituto Impulso Coaching de Lideran√ßa</title>
<style>
:root{
  --bg1:#052e16; --bg2:#166534; --bg3:#22c55e;
  --card:rgba(255,255,255,.10);
  --card2:rgba(255,255,255,.14);
  --border:rgba(255,255,255,.18);
  --text:#ecfdf5;
  --muted:rgba(236,253,245,.75);
  --shadow:0 18px 60px rgba(0,0,0,.35);
  --accent:#34d399;
  --accent2:#a7f3d0;
  --danger:#fb7185;
  --warn:#fbbf24;
  --ok:#22c55e;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
  background: radial-gradient(1000px 700px at 15% 10%, rgba(134,239,172,.28), transparent 60%),
              radial-gradient(900px 700px at 85% 25%, rgba(52,211,153,.24), transparent 55%),
              linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 42%,var(--bg3) 100%);
}

a{color:inherit}
.container{max-width:1100px;margin:0 auto;padding:26px 18px 70px}
.header{
  display:flex;flex-direction:column;gap:10px;
  padding:22px 20px;border:1px solid var(--border);
  background:linear-gradient(180deg,rgba(255,255,255,.12),rgba(255,255,255,.08));
  border-radius:18px;box-shadow:var(--shadow);
  backdrop-filter: blur(10px);
}
.brand{display:flex;justify-content:space-between;align-items:center;gap:14px;flex-wrap:wrap}
.institute{font-weight:700;letter-spacing:.2px}
.tag{
  padding:7px 10px;border-radius:999px;
  border:1px solid var(--border);
  background:rgba(0,0,0,.12);
  color:var(--muted);
  font-size:12px;
}
h1{margin:0;font-size:28px;line-height:1.15}
.sub{margin:0;color:var(--muted);max-width:900px}

.badges{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}
.badge-item{
  font-size:12px;padding:7px 10px;border-radius:999px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.08);
  color:var(--accent2);
}

.grid{display:grid;grid-template-columns:1.1fr .9fr;gap:16px;margin-top:16px}
@media (max-width:900px){.grid{grid-template-columns:1fr}}

.card{
  border:1px solid var(--border);
  background:linear-gradient(180deg,rgba(255,255,255,.11),rgba(255,255,255,.07));
  border-radius:18px;
  box-shadow:var(--shadow);
  backdrop-filter: blur(10px);
}
.card-inner{padding:18px}

.section-title{margin:0 0 12px;font-size:16px;letter-spacing:.2px}
.small{font-size:12px;color:var(--muted);margin-top:6px}

.form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:650px){.form{grid-template-columns:1fr}}
.form-group{display:flex;flex-direction:column;gap:6px}
label{font-size:12px;color:var(--muted);letter-spacing:.25px}
input{
  width:100%;
  padding:12px 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.20);
  background:rgba(0,0,0,.12);
  color:var(--text);
  outline:none;
}
input:focus{border-color:rgba(167,243,208,.65);box-shadow:0 0 0 4px rgba(52,211,153,.12)}

.btn-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
button{
  border:1px solid transparent;
  border-radius:12px;
  padding:12px 14px;
  cursor:pointer;
  font-weight:700;
  letter-spacing:.2px;
}
.btn-primary{
  background:linear-gradient(180deg,#34d399,#10b981);
  color:#06281c;
}
.btn-secondary{
  background:rgba(0,0,0,.14);
  color:var(--text);
  border-color:rgba(255,255,255,.22);
}
.btn-outline{
  background:transparent;
  color:var(--text);
  border-color:rgba(255,255,255,.28);
}
button:disabled{opacity:.55;cursor:not-allowed}

.hr{height:1px;background:rgba(255,255,255,.14);margin:14px 0}

.progress{
  display:flex;align-items:center;justify-content:space-between;
  gap:10px;margin-bottom:10px
}
.progress-label,.progress-pct{font-size:12px;color:var(--muted)}
.progress-bar{
  height:10px;border-radius:999px;background:rgba(0,0,0,.18);
  border:1px solid rgba(255,255,255,.18);
  overflow:hidden;
}
.progress-fill{height:100%;width:0%;background:linear-gradient(90deg,#a7f3d0,#34d399,#10b981)}

.dim-head{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap}
.dim-tag{
  font-size:12px;color:#06281c;
  background:linear-gradient(180deg,#a7f3d0,#34d399);
  padding:6px 10px;border-radius:999px;
}
.dim-title{margin:0;font-size:18px}
.dim-desc{margin:8px 0 0;color:var(--muted);font-size:13px;max-width:900px}

.q-list{display:flex;flex-direction:column;gap:10px;margin-top:14px}
.question-card{
  padding:14px;border-radius:14px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.10);
}
.q-text{margin:0 0 10px;font-size:14px;line-height:1.35}
.q-num{color:var(--accent2);font-weight:800;margin-right:6px}
.likert{display:flex;gap:8px;flex-wrap:wrap}
.lk-btn{
  flex:1 1 150px;
  padding:10px 10px;
  background:rgba(255,255,255,.07);
  border:1px solid rgba(255,255,255,.18);
  color:var(--text);
}
.lk-btn strong{display:block;font-size:13px}
.lk-btn span{display:block;font-size:11px;color:var(--muted);margin-top:2px}
.lk-btn.active{
  border-color:rgba(167,243,208,.70);
  background:rgba(52,211,153,.20);
  box-shadow:0 0 0 4px rgba(52,211,153,.10) inset;
}

.hidden{display:none!important}

.result-top{display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;align-items:center}
.res-participant{color:var(--muted);font-size:12px}
.iga-wrap{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
@media (max-width:900px){.iga-wrap{grid-template-columns:1fr}}

.kpi{
  padding:14px;border-radius:16px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.10);
}
.kpi-label{font-size:12px;color:var(--muted)}
.kpi-value{font-size:30px;font-weight:900;margin-top:6px}
.kpi-sub{font-size:12px;color:var(--muted);margin-top:4px}

.iga-badge{
  display:inline-flex;align-items:center;gap:8px;
  padding:8px 10px;border-radius:999px;
  font-size:12px;font-weight:900;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(0,0,0,.14);
}
.profile{
  margin-top:10px;padding:14px;border-radius:16px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(0,0,0,.10);
}
.profile h3{margin:0 0 6px;font-size:16px}
.profile p{margin:0;color:var(--muted);font-size:13px;line-height:1.45}

.table-wrap{overflow:auto;border-radius:14px;border:1px solid rgba(255,255,255,.16);margin-top:12px}
table{width:100%;border-collapse:collapse;min-width:720px;background:rgba(0,0,0,.10)}
th,td{padding:10px 10px;border-bottom:1px solid rgba(255,255,255,.12);font-size:13px}
th{color:var(--accent2);text-align:left;font-size:12px;letter-spacing:.25px}
td{color:rgba(236,253,245,.92)}
tr:last-child td{border-bottom:none}

.pills{display:flex;flex-direction:column;gap:8px;margin-top:10px}
.pill{
  display:flex;gap:10px;align-items:flex-start;
  padding:10px 12px;border-radius:14px;
  border:1px solid rgba(255,255,255,.16);
  background:rgba(0,0,0,.10);
}
.pill b{color:var(--accent2)}
.pill span{color:var(--muted);font-size:13px;line-height:1.35}
.footer-note{margin-top:10px;color:var(--muted);font-size:12px;line-height:1.4}
</style>
</head>
<body>
<div class="container">

  <div class="header">
    <div class="brand">
      <div class="institute">Instituto Impulso Coaching de Lideran√ßa</div>
      <div class="tag">Tempo m√©dio: ~8 minutos ‚Ä¢ 40 itens ‚Ä¢ Resultado imediato</div>
    </div>
    <h1>Avalia√ß√£o de Auto-Estima Saud√°vel</h1>
    <p class="sub">Ferramenta cientificamente inspirada em modelos validados para mensurar seu √çndice Global de Autoestima (IGA) ‚Äî parte essencial da Intelig√™ncia Emocional Saud√°vel.</p>
    <div class="badges" aria-label="Bases te√≥ricas citadas">
      <div class="badge-item">Escala de Rosenberg</div>
      <div class="badge-item">Invent√°rio Coopersmith</div>
      <div class="badge-item">Self-Compassion Scale (Neff)</div>
      <div class="badge-item">IE de Goleman</div>
      <div class="badge-item">Bren√© Brown</div>
    </div>
  </div>

  <div class="grid">
    <div class="card" id="cardStart">
      <div class="card-inner">
        <h2 class="section-title">Informa√ß√µes do Participante</h2>

        <div class="form">
          <div class="form-group">
            <label for="name">NOME COMPLETO *</label>
            <input id="name" autocomplete="name" placeholder="Digite seu nome completo"/>
          </div>
          <div class="form-group">
            <label for="email">E-MAIL *</label>
            <input id="email" autocomplete="email" placeholder="nome@exemplo.com"/>
          </div>
        </div>

        <div class="btn-row">
          <button class="btn-primary" id="btnStart">Iniciar Avalia√ß√£o Agora</button>
          <button class="btn-secondary" id="btnLoad">Carregar Progresso</button>
          <button class="btn-outline" id="btnReset">Limpar</button>
        </div>

        <div class="footer-note">
          Observa√ß√£o: este instrumento √© educativo e de desenvolvimento pessoal. Se voc√™ estiver em sofrimento emocional significativo, considere buscar apoio profissional qualificado.
        </div>
      </div>
    </div>

    <div class="card" id="cardInfo">
      <div class="card-inner">
        <h2 class="section-title">Como responder</h2>
        <p class="small">
          Leia cada afirma√ß√£o e escolha a op√ß√£o que melhor descreve como voc√™ tem se sentido na maior parte do tempo.
          Responda com sinceridade ‚Äî n√£o existe ‚Äúcerto ou errado‚Äù.
        </p>
        <div class="hr"></div>
        <p class="small">
          Escala (1 a 5): 1 = Discordo totalmente ‚Ä¢ 5 = Concordo totalmente.
        </p>
      </div>
    </div>
  </div>

  <div class="card hidden" id="cardQuiz" style="margin-top:16px">
    <div class="card-inner">

      <div class="progress">
        <div class="progress-label" id="progressLabel">Dimens√£o 1 de 5</div>
        <div class="progress-pct" id="progressPct">20%</div>
      </div>
      <div class="progress-bar" aria-label="Progresso">
        <div class="progress-fill" id="progressFill"></div>
      </div>

      <div class="dim-head" style="margin-top:14px">
        <div>
          <div class="dim-tag" id="dimTag">Dimens√£o 1 de 5 ‚Ä¢ üíé</div>
          <h2 class="dim-title" id="dimTitle">‚Äî</h2>
          <p class="dim-desc" id="dimDesc">‚Äî</p>
        </div>
      </div>

      <div class="q-list" id="qList"></div>

      <div class="btn-row" style="margin-top:14px">
        <button class="btn-secondary" id="btnPrev">‚óÄ Anterior</button>
        <button class="btn-primary" id="btnNext">Pr√≥ximo ‚ñ∂</button>
        <button class="btn-outline" id="btnSave">Salvar Progresso</button>
      </div>

      <div class="small" id="saveHint" style="margin-top:10px"></div>
    </div>
  </div>

  <div class="card hidden" id="cardResult" style="margin-top:16px">
    <div class="card-inner">
      <div class="result-top">
        <h2 class="section-title" style="margin:0">Seu Resultado</h2>
        <div class="res-participant" id="resParticipant">‚Äî</div>
      </div>

      <div class="iga-wrap">
        <div class="kpi">
          <div class="kpi-label">√çndice Global de Autoestima (IGA)</div>
          <div class="kpi-value" id="igaPct">‚Äî%</div>
          <div class="kpi-sub" id="igaSub">‚Äî</div>
          <div style="margin-top:10px">
            <span class="iga-badge" id="igaBadge">‚Äî</span>
          </div>
        </div>

        <div class="profile">
          <h3><span id="profileIcon">‚Äî</span> <span id="profileName">‚Äî</span></h3>
          <p id="profileText">‚Äî</p>
        </div>
      </div>

      <div class="hr"></div>

      <h3 class="section-title">Tabela Detalhada</h3>
      <div class="table-wrap" role="region" aria-label="Tabela detalhada de resultados">
        <table>
          <thead>
            <tr>
              <th>Dimens√£o</th><th>Pts</th><th>%</th><th>N√≠vel</th><th>Interpreta√ß√£o</th>
            </tr>
          </thead>
          <tbody id="tblBody"></tbody>
        </table>
      </div>

      <div class="hr"></div>

      <div class="grid" style="grid-template-columns:1fr 1fr;gap:16px">
        <div class="card" style="box-shadow:none">
          <div class="card-inner">
            <h3 class="section-title">Pontos Fortes</h3>
            <div class="pills" id="strengths"></div>
          </div>
        </div>
        <div class="card" style="box-shadow:none">
          <div class="card-inner">
            <h3 class="section-title">√Åreas de Desenvolvimento</h3>
            <div class="pills" id="devs"></div>
          </div>
        </div>
      </div>

      <div class="hr"></div>

      <h3 class="section-title">Recomenda√ß√µes Personalizadas</h3>
      <div class="pills" id="recs"></div>

      <div class="btn-row" style="margin-top:14px">
        <button class="btn-secondary" id="btnPrint">üíæ Salvar PDF (Imprimir)</button>
        <button class="btn-secondary" id="btnEmail">üìß Copiar resumo para e-mail</button>
        <button class="btn-outline" id="btnNew">üîÑ Nova Avalia√ß√£o</button>
      </div>

      <div class="footer-note" id="emailCopyHint"></div>
    </div>
  </div>

</div>

<script>
"use strict";

/* ==========================
   DADOS (5 dimens√µes / 40 itens)
   ========================== */
const DIMENSIONS = [
  {
    key:"d1",
    icon:"üíé",
    title:"Autovaloriza√ß√£o e Autoaceita√ß√£o",
    desc:"Mede o reconhecimento do seu valor pessoal e a capacidade de aceitar a si mesmo com autenticidade, incluindo falhas e limita√ß√µes.",
    items:[
      "Sinto que sou uma pessoa de valor, pelo menos tanto quanto outras pessoas.",
      "Consigo reconhecer qualidades em mim, mesmo quando erro.",
      "Aceito que tenho limita√ß√µes sem me diminuir por isso.",
      "Consigo me tratar com respeito, mesmo em dias dif√≠ceis.",
      "Eu me sinto digno(a) de amor e considera√ß√£o.",
      "Eu me reconhe√ßo como algu√©m importante para mim mesmo(a).",
      "Eu me permito ser humano(a), sem me exigir perfei√ß√£o.",
      "Eu consigo separar meu valor pessoal dos meus resultados."
    ],
    recs:[
      "Pratique um di√°rio de evid√™ncias: 3 atitudes suas por dia que demonstram valor (mesmo pequenas).",
      "Treine a frase: ‚ÄúEu posso melhorar sem me humilhar‚Äù.",
      "Defina um limite saud√°vel de autoexig√™ncia: 80% bem feito √© melhor que 0% perfeito."
    ]
  },
  {
    key:"d2",
    icon:"üöÄ",
    title:"Autoconfian√ßa e Compet√™ncia Percebida",
    desc:"Avalia quanto voc√™ confia na sua capacidade de agir, aprender e alcan√ßar resultados, mesmo diante de desafios.",
    items:[
      "Eu confio que consigo aprender coisas novas quando necess√°rio.",
      "Eu me considero capaz de lidar com problemas do dia a dia.",
      "Quando falho, consigo tentar de novo sem desistir de mim.",
      "Eu me sinto competente naquilo que fa√ßo na maior parte do tempo.",
      "Eu tomo decis√µes com razo√°vel seguran√ßa.",
      "Eu reconhe√ßo minhas conquistas sem minimiz√°-las.",
      "Eu consigo me posicionar quando preciso.",
      "Eu sinto que tenho recursos internos para enfrentar desafios."
    ],
    recs:[
      "Liste 10 vit√≥rias reais (pequenas e grandes) e releia quando a inseguran√ßa aparecer.",
      "Use a regra do pr√≥ximo passo: escolha uma a√ß√£o pequena e execut√°vel em 15 minutos.",
      "Transforme ‚Äún√£o sei‚Äù em ‚Äúainda n√£o aprendi‚Äù."
    ]
  },
  {
    key:"d3",
    icon:"üß©",
    title:"Autoimagem e Aceita√ß√£o Social",
    desc:"Explora como voc√™ se percebe, como lida com compara√ß√£o e quanto se sente aceito(a) e pertencente.",
    items:[
      "Eu me sinto confort√°vel em ser quem eu sou perto de outras pessoas.",
      "Eu n√£o me comparo o tempo todo de forma que me fa√ßa mal.",
      "Eu consigo receber elogios sem desconfiar ou rejeitar.",
      "Eu me sinto pertencente em ambientes sociais importantes para mim.",
      "Eu consigo dizer ‚Äún√£o‚Äù sem medo excessivo de rejei√ß√£o.",
      "Eu n√£o baseio meu valor apenas na opini√£o dos outros.",
      "Eu me sinto relativamente seguro(a) com minha imagem.",
      "Eu consigo estar em grupo sem me sentir inferior."
    ],
    recs:[
      "Fa√ßa uma semana de ‚Äúdesintoxica√ß√£o de compara√ß√£o‚Äù: reduza gatilhos (redes/contas) que te fazem se diminuir.",
      "Treine receber elogios com: ‚ÄúObrigado(a), eu aceito‚Äù.",
      "Reforce pertencimento: procure 1 ambiente onde voc√™ possa ser aut√™ntico(a)."
    ]
  },
  {
    key:"d4",
    icon:"üíö",
    title:"Autocompaix√£o e Di√°logo Interno",
    desc:"Mensura como voc√™ conversa consigo mesmo(a) e se voc√™ se apoia emocionalmente em vez de se punir.",
    items:[
      "Quando erro, eu evito me chamar de nomes ou me humilhar.",
      "Eu consigo me acolher quando estou triste ou frustrado(a).",
      "Eu falo comigo mesmo(a) como falaria com algu√©m que amo.",
      "Eu consigo reconhecer que sofrer faz parte de ser humano.",
      "Eu me permito descansar sem culpa excessiva.",
      "Eu consigo ser firme comigo sem ser cruel.",
      "Eu noto quando meu cr√≠tico interno aparece e consigo ajustar o tom.",
      "Eu consigo me perdoar por escolhas do passado."
    ],
    recs:[
      "Nomeie o cr√≠tico interno e responda com um ‚Äòmentor interno‚Äô (tom firme e gentil).",
      "Use a pergunta: ‚ÄúO que eu preciso agora para me regular?‚Äù",
      "Fa√ßa 2 minutos/dia de respira√ß√£o 4-6 (inspira 4, expira 6) para reduzir autocobran√ßa."
    ]
  },
  {
    key:"d5",
    icon:"üõ°Ô∏è",
    title:"Estabilidade Emocional e Resili√™ncia",
    desc:"Avalia como voc√™ lida com emo√ß√µes, estresse e recupera√ß√£o ap√≥s situa√ß√µes dif√≠ceis.",
    items:[
      "Eu consigo me acalmar depois de situa√ß√µes estressantes.",
      "Eu n√£o fico preso(a) por muito tempo em pensamentos autodepreciativos.",
      "Eu consigo pedir ajuda quando preciso.",
      "Eu me recupero relativamente bem ap√≥s cr√≠ticas ou conflitos.",
      "Eu consigo tolerar frustra√ß√£o sem me desorganizar totalmente.",
      "Eu consigo manter esperan√ßa mesmo em fases dif√≠ceis.",
      "Eu reconhe√ßo minhas emo√ß√µes sem ser dominado(a) por elas.",
      "Eu aprendo com dificuldades ao inv√©s de me definir por elas."
    ],
    recs:[
      "Crie um plano de regula√ß√£o: sono, movimento, alimenta√ß√£o e pausas (m√≠nimo vi√°vel).",
      "Quando vier a emo√ß√£o forte, use: Nomear ‚Üí Normalizar ‚Üí Necessidade ‚Üí Pr√≥xima a√ß√£o.",
      "Estabele√ßa uma rede: 2 pessoas para apoio emocional e 2 para apoio pr√°tico."
    ]
  }
];

const LIKERT = [
  {v:1, label:"Discordo Totalmente"},
  {v:2, label:"Discordo"},
  {v:3, label:"Neutro"},
  {v:4, label:"Concordo"},
  {v:5, label:"Concordo Totalmente"}
];

/* ==========================
   ESTADO
   ========================== */
const state = {
  name:"",
  email:"",
  dimIndex:0,
  // respostas por dimens√£o: array de 8 n√∫meros (1-5)
  answers: DIMENSIONS.map(d => Array(d.items.length).fill(null))
};

const STORAGE_KEY = "impulso_autoestima_v1";

/* ==========================
   UTIL
   ========================== */
function el(id){ return document.getElementById(id); }
function todayBR(){
  const d = new Date();
  return d.toLocaleDateString("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit"});
}
function clamp(n,min,max){ return Math.max(min,Math.min(max,n)); }
function pct(n){ return Math.round(n); }
function dimScore(dimIdx){
  const arr = state.answers[dimIdx];
  const answered = arr.filter(x => typeof x === "number").length;
  const pts = arr.reduce((s,x)=> s + (typeof x==="number"? x : 0), 0);
  const max = DIMENSIONS[dimIdx].items.length * 5;
  const min = DIMENSIONS[dimIdx].items.length * 1;
  const pctVal = answered===DIMENSIONS[dimIdx].items.length ? (pts / max) * 100 : null;
  return {answered, pts, max, min, pct:pctVal};
}
function igaScore(){
  const all = state.answers.flat();
  const answered = all.filter(x => typeof x === "number").length;
  const pts = all.reduce((s,x)=> s + (typeof x==="number"? x : 0), 0);
  const max = all.length * 5;
  const pctVal = answered===all.length ? (pts / max) * 100 : null;
  return {answered, pts, max, pct:pctVal};
}
function levelFromPct(p){
  if (p < 35) return {lvl:"Muito Baixo", color:"var(--danger)"};
  if (p < 55) return {lvl:"Baixo", color:"var(--warn)"};
  if (p < 70) return {lvl:"Moderado", color:"var(--accent2)"};
  if (p < 85) return {lvl:"Bom", color:"var(--ok)"};
  return {lvl:"Excelente", color:"var(--accent2)"};
}
function profileFromIGA(p){
  // perfis exemplificativos (inclui o citado no seu conte√∫do)
  if (p < 35) return {
    icon:"üî¥",
    name:"O Cr√≠tico Interno",
    text:"Voc√™ tende a ter uma voz interna muito exigente e punitiva. Sua autoestima est√° em um n√≠vel que gera sofrimento emocional significativo. Voc√™ pode se sentir indigno(a), inferior ou em d√≠vida consigo. Este √© um excelente ponto de partida para uma jornada de transforma√ß√£o necess√°ria."
  };
  if (p < 55) return {
    icon:"üü†",
    name:"O Comparador Inseguro",
    text:"Sua autoestima oscila e √© sens√≠vel a cr√≠ticas, compara√ß√£o e desempenho. Em dias bons, voc√™ se sente ok; em dias dif√≠ceis, a autoconfian√ßa cai r√°pido. O foco aqui √© construir base interna e consist√™ncia emocional."
  };
  if (p < 70) return {
    icon:"üü°",
    name:"O Realista em Constru√ß√£o",
    text:"Voc√™ tem recursos importantes, mas ainda alterna entre autoconfian√ßa e autocr√≠tica. Com ajustes no di√°logo interno e fortalecimento de compet√™ncias emocionais, seu IGA pode subir com relativa rapidez."
  };
  if (p < 85) return {
    icon:"üü¢",
    name:"O Confiante Equilibrado",
    text:"Voc√™ se valoriza e tende a se recuperar bem de desafios. Ainda h√° pontos pontuais de evolu√ß√£o, mas seu padr√£o geral √© saud√°vel e consistente."
  };
  return {
    icon:"üü£",
    name:"O Autol√≠der",
    text:"Sua autoestima √© est√°vel e bem integrada. Voc√™ se aceita, confia na sua capacidade e se regula emocionalmente com maturidade. O pr√≥ximo n√≠vel √© manter consist√™ncia e usar isso para liderar com presen√ßa."
  };
}

/* ==========================
   RENDER
   ========================== */
function show(id){
  ["cardStart","cardInfo","cardQuiz","cardResult"].forEach(x=>el(x).classList.add("hidden"));
  el(id).classList.remove("hidden");
}

function renderDimension(){
  const i = state.dimIndex;
  const dim = DIMENSIONS[i];

  el("progressLabel").textContent = `Dimens√£o ${i+1} de ${DIMENSIONS.length}`;
  const progress = ((i+1)/DIMENSIONS.length)*100;
  el("progressPct").textContent = `${pct(progress)}%`;
  el("progressFill").style.width = `${progress}%`;

  el("dimTag").textContent = `Dimens√£o ${i+1} de ${DIMENSIONS.length} ‚Ä¢ ${dim.icon}`;
  el("dimTitle").textContent = dim.title;
  el("dimDesc").textContent = dim.desc;

  const qList = el("qList");
  qList.innerHTML = "";

  dim.items.forEach((txt, qIdx) => {
    const card = document.createElement("div");
    card.className = "question-card";

    const p = document.createElement("p");
    p.className = "q-text";
    p.innerHTML = `<span class="q-num">${qIdx+1}.</span>${escapeHtml(txt)}`;
    card.appendChild(p);

    const lk = document.createElement("div");
    lk.className = "likert";

    LIKERT.forEach(opt => {
      const b = document.createElement("button");
      b.type="button";
      b.className="lk-btn";
      b.innerHTML = `<strong>${opt.v}</strong><span>${escapeHtml(opt.label)}</span>`;
      const current = state.answers[i][qIdx];
      if (current === opt.v) b.classList.add("active");
      b.addEventListener("click", () => {
        state.answers[i][qIdx] = opt.v;
        renderDimension();
      });
      lk.appendChild(b);
    });

    card.appendChild(lk);
    qList.appendChild(card);
  });

  el("btnPrev").disabled = (i===0);
  el("btnNext").textContent = (i===DIMENSIONS.length-1) ? "‚úÖ Ver Meus Resultados" : "Pr√≥ximo ‚ñ∂";
  el("saveHint").textContent = progressText();
}

function progressText(){
  const all = state.answers.flat();
  const answered = all.filter(x => typeof x === "number").length;
  return `Progresso: ${answered}/${all.length} respostas preenchidas.`;
}

function renderResults(){
  const iga = igaScore();
  if (iga.pct === null){
    alert("Por favor, responda todas as perguntas antes de ver os resultados.");
    return;
  }

  const name = state.name.trim();
  const email = state.email.trim();
  el("resParticipant").innerHTML = `üë§ <strong>${escapeHtml(name)}</strong> &nbsp;|&nbsp; üìÖ ${todayBR()} &nbsp;|&nbsp; ‚úâÔ∏è ${escapeHtml(email)}`;

  const igaP = clamp(iga.pct,0,100);
  const lvl = levelFromPct(igaP);
  el("igaPct").textContent = `${pct(igaP)}%`;
  el("igaSub").textContent = `Pontua√ß√£o: ${iga.pts}/${iga.max} ‚Ä¢ N√≠vel: ${lvl.lvl}`;
  el("igaBadge").textContent = `IGA ‚Ä¢ ${lvl.lvl}`;
  el("igaBadge").style.borderColor = lvl.color;

  const prof = profileFromIGA(igaP);
  el("profileIcon").textContent = prof.icon;
  el("profileName").textContent = prof.name;
  el("profileText").textContent = prof.text;

  // tabela por dimens√£o
  const tb = el("tblBody");
  tb.innerHTML = "";
  const dimRows = DIMENSIONS.map((d, idx) => {
    const s = dimScore(idx);
    const p = (s.pct===null) ? 0 : s.pct;
    const lv = levelFromPct(p);
    return {idx, title:d.title, pts:s.pts, max:s.max, pct:p, lvl:lv.lvl, interp:interpretDim(p)};
  });

  dimRows.forEach(r=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${escapeHtml(r.title)}</td><td>${r.pts}/${r.max}</td><td>${pct(r.pct)}%</td><td>${escapeHtml(r.lvl)}</td><td>${escapeHtml(r.interp)}</td>`;
    tb.appendChild(tr);
  });

  // pontos fortes e desenvolvimento (top2 / bottom2)
  const sorted = [...dimRows].sort((a,b)=> b.pct - a.pct);
  const top2 = sorted.slice(0,2);
  const bot2 = sorted.slice(-2).reverse();

  el("strengths").innerHTML = "";
  top2.forEach(r=>{
    el("strengths").appendChild(pill("‚úÖ "+r.title, `Voc√™ pontuou ${pct(r.pct)}%. Mantenha pr√°ticas que sustentam este eixo.`));
  });

  el("devs").innerHTML = "";
  bot2.forEach(r=>{
    el("devs").appendChild(pill("üéØ "+r.title, `Voc√™ pontuou ${pct(r.pct)}%. Aqui est√£o as alavancas mais r√°pidas para elevar seu IGA.`));
  });

  // recomenda√ß√µes: para dimens√µes abaixo de 70%, puxar recs; sen√£o, refor√ßo
  el("recs").innerHTML = "";
  dimRows.forEach(r=>{
    const dim = DIMENSIONS[r.idx];
    const header = `${dim.title} ‚Äî ${pct(r.pct)}%`;
    if (r.pct < 70){
      const text = dim.recs.map(x=>"‚Ä¢ "+x).join(" ");
      el("recs").appendChild(pill(header, text));
    } else {
      el("recs").appendChild(pill(header, "‚Ä¢ Continue refor√ßando h√°bitos e ambientes que sustentam esse resultado. ‚Ä¢ Ensine/compartilhe o que funciona: isso consolida o padr√£o interno."));
    }
  });

  el("emailCopyHint").textContent = "";
}

function pill(title, text){
  const div = document.createElement("div");
  div.className="pill";
  const b = document.createElement("b");
  b.textContent = title;
  const span = document.createElement("span");
  span.textContent = text;
  div.appendChild(b);
  div.appendChild(span);
  return div;
}

function interpretDim(p){
  if (p < 35) return "Indicador cr√≠tico: alta autocr√≠tica e baixa base interna. Requer aten√ß√£o e apoio.";
  if (p < 55) return "Base inst√°vel: sens√≠vel a estresse, compara√ß√£o e valida√ß√£o externa.";
  if (p < 70) return "Em constru√ß√£o: recursos presentes, mas ainda inconsistentes em press√£o.";
  if (p < 85) return "Saud√°vel: boa base interna, com pontos pontuais a refinar.";
  return "Muito saud√°vel: forte consist√™ncia, autorregula√ß√£o e autolideran√ßa.";
}

function escapeHtml(s){
  return String(s)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

/* ==========================
   EVENTOS
   ========================== */
el("btnStart").addEventListener("click", () => {
  const name = el("name").value.trim();
  const email = el("email").value.trim();
  if (!name || !email){
    alert("Preencha Nome e E-mail para iniciar.");
    return;
  }
  state.name = name;
  state.email = email;
  state.dimIndex = 0;
  show("cardQuiz");
  renderDimension();
});

el("btnPrev").addEventListener("click", () => {
  state.dimIndex = Math.max(0, state.dimIndex - 1);
  renderDimension();
});

el("btnNext").addEventListener("click", () => {
  if (state.dimIndex < DIMENSIONS.length - 1){
    state.dimIndex += 1;
    renderDimension();
    return;
  }
  // √∫ltima dimens√£o -> resultados
  show("cardResult");
  renderResults();
});

el("btnSave").addEventListener("click", () => {
  const payload = {
    name: el("name").value.trim() || state.name,
    email: el("email").value.trim() || state.email,
    dimIndex: state.dimIndex,
    answers: state.answers
  };
  localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
  el("saveHint").textContent = "Progresso salvo neste navegador.";
});

el("btnLoad").addEventListener("click", () => {
  const raw = localStorage.getItem(STORAGE_KEY);
  if (!raw){ alert("Nenhum progresso salvo encontrado."); return; }
  const data = JSON.parse(raw);
  state.name = data.name || "";
  state.email = data.email || "";
  state.dimIndex = Number.isFinite(data.dimIndex) ? data.dimIndex : 0;
  state.answers = Array.isArray(data.answers) ? data.answers : state.answers;

  el("name").value = state.name;
  el("email").value = state.email;

  show("cardQuiz");
  renderDimension();
});

el("btnReset").addEventListener("click", () => {
  el("name").value = "";
  el("email").value = "";
  state.name=""; state.email=""; state.dimIndex=0;
  state.answers = DIMENSIONS.map(d => Array(d.items.length).fill(null));
  localStorage.removeItem(STORAGE_KEY);
  alert("Dados limpos.");
});

el("btnPrint").addEventListener("click", () => window.print());

el("btnEmail").addEventListener("click", async () => {
  const iga = igaScore();
  if (iga.pct === null) return;

  const lines = [];
  lines.push("Resultado ‚Äî Avalia√ß√£o de Auto-Estima Saud√°vel");
  lines.push(`Participante: ${state.name} | ${state.email} | Data: ${todayBR()}`);
  lines.push(`IGA: ${pct(iga.pct)}% (${iga.pts}/${iga.max})`);
  lines.push("");
  DIMENSIONS.forEach((d, i) => {
    const s = dimScore(i);
    const p = (s.pct===null)?0:s.pct;
    lines.push(`${d.title}: ${pct(p)}% (${s.pts}/${s.max})`);
  });

  const text = lines.join("\n");
  try{
    await navigator.clipboard.writeText(text);
    el("emailCopyHint").textContent = "Resumo copiado para a √°rea de transfer√™ncia. Cole no seu e-mail.";
  }catch(e){
    el("emailCopyHint").textContent = "N√£o foi poss√≠vel copiar automaticamente. Selecione e copie manualmente no console (F12) ou tente outro navegador.";
  }
});

el("btnNew").addEventListener("click", () => {
  state.dimIndex = 0;
  state.answers = DIMENSIONS.map(d => Array(d.items.length).fill(null));
  show("cardStart");
});

</script>
</body>
</html>
